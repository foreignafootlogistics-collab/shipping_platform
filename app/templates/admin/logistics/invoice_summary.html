{% extends "layout_admin.html" %}
{% block title %}Invoice Summary{% endblock %}
{% block content %}
<div class="card shadow-sm p-3">
  <h4 class="text-purple fw-bold">ðŸ§¾ Invoice Summary</h4>
  <p class="small text-muted">Review selected customers and amounts before generating invoices.</p>

  <form method="POST" action="{{ url_for('admin.generate_bulk_invoice') }}">
    <input type="hidden" name="shipment_id" value="{{ shipment_id }}">

    <table class="table table-bordered table-sm align-middle">
      <thead class="table-light">
        <tr>
          <th>Select</th>
          <th>Customer</th>
          <th>Packages</th>
          <th>Total Due (JMD)</th>
        </tr>
      </thead>
      <tbody>
        {% for row in summary %}
        <tr>
          <td>
            <input type="checkbox" name="user_ids" value="{{ row.user_id }}" checked>
          </td>
          <td>
            <strong>{{ row.registration_number }}</strong> {{ row.full_name }}
          </td>
          <td>{{ row.pkg_count }}</td>
          <td class="fw-bold text-success">${{ "%.2f"|format(row.total_due or 0) }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <div class="d-flex justify-content-end gap-2 mt-3">
      <button type="submit" class="btn btn-success btn-sm">Generate</button>
      <a href="{{ url_for('logistics.shipment_log', shipment_id=shipment_id) }}" class="btn btn-secondary btn-sm">
        Cancel
      </a>
    </div>
  </form>
</div>
{% endblock %}
