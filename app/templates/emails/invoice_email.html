<!doctype html>
<html>
  <body style="font-family: Arial, sans-serif; background:#f6f7fb; margin:0; padding:0;">
    <div style="max-width:760px; margin:0 auto; padding:24px;">
      
      <!-- Card -->
      <div style="background:#ffffff; border:1px solid #e5e7eb; border-radius:14px; overflow:hidden;">
        
        <!-- Header -->
        <div style="padding:22px 22px 10px; border-bottom:1px solid #e5e7eb;">
          <div style="text-align:center;">
            <img src="{{ LOGO_URL if LOGO_URL is defined else 'https://app.faflcourier.com/static/logo.png' }}"
                 alt="FAFL Logo" style="max-width:170px; height:auto;">
          </div>

          <h2 style="margin:16px 0 6px; text-align:center; color:#4a148c; font-size:22px;">
            Invoice {{ invoice.number }} is Ready
          </h2>

          <p style="margin:0; text-align:center; color:#6b7280; font-size:14px;">
            Hi {{ full_name }}, your invoice is attached and available online.
          </p>
        </div>

        <!-- Total Due -->
        <div style="padding:18px 22px;">
          <div style="background:#faf7ff; border:1px solid #eadcff; border-radius:12px; padding:16px;">
            <div style="color:#6b7280; font-size:13px; margin-bottom:6px;">Total Due</div>
            <div style="font-size:30px; font-weight:800; color:#4a148c;">
              {{ invoice.total_due|jmd if invoice.total_due is not none else "" }}
            </div>

            <div style="margin-top:10px; color:#6b7280; font-size:13px;">
              Invoice #: <b style="color:#111827;">{{ invoice.number }}</b>
              {% if invoice.date %}
              <span style="margin-left:10px;">Date: <b style="color:#111827;">
                {{ invoice.date|datetimeformat('%Y-%m-%d %H:%M') }}
              </b></span>
              {% endif %}
            </div>
          </div>

          <!-- CTA -->
          <div style="text-align:center; margin:18px 0 4px;">
            <a href="{{ transactions_url }}"
               style="display:inline-block; background:#4a148c; color:#fff; text-decoration:none;
                      padding:12px 18px; border-radius:10px; font-weight:700; font-size:14px;">
              View Details / Pay
            </a>
          </div>

          <p style="text-align:center; margin:10px 0 0; color:#6b7280; font-size:12px;">
            Or copy & paste: {{ transactions_url }}
          </p>
        </div>

        <!-- Invoice body -->
        <div style="padding:0 22px 22px;">
          <div style="border:1px solid #e5e7eb; border-radius:12px; overflow:hidden;">
            
            <div style="padding:14px 14px 10px; border-bottom:1px solid #e5e7eb;">
              <div style="font-weight:700; color:#111827;">Customer</div>
              <div style="color:#111827;">{{ invoice.customer_name }}</div>
              <div style="color:#6b7280; font-size:12px;">{{ invoice.customer_code }}</div>
            </div>

            <div style="padding:12px 14px; border-bottom:1px solid #e5e7eb;">
              <div style="display:flex; justify-content:space-between; gap:12px; flex-wrap:wrap;">
                <div style="color:#374151;">Subtotal: <b>{{ invoice.subtotal|jmd }}</b></div>
                <div style="color:#374151;">Discounts: <b>- {{ invoice.discount_total|jmd }}</b></div>
                <div style="color:#111827;">Amount Owed: <b>{{ invoice.total_due|jmd }}</b></div>
              </div>
            </div>

            <div style="padding:14px;">
              <table style="width:100%; border-collapse:collapse; font-size:13px;">
                <thead>
                  <tr style="background:#111827; color:#fff;">
                    <th style="padding:10px; border:1px solid #e5e7eb; text-align:left; width:140px;">House AWB#</th>
                    <th style="padding:10px; border:1px solid #e5e7eb; text-align:left;">Information</th>
                    <th style="padding:10px; border:1px solid #e5e7eb; text-align:left; width:180px;">Our Fees</th>
                    <th style="padding:10px; border:1px solid #e5e7eb; text-align:left; width:180px;">Govt Fees</th>
                    <th style="padding:10px; border:1px solid #e5e7eb; text-align:left; width:120px;">Discount Due</th>
                  </tr>
                </thead>

                <tbody>
                  {% for p in invoice.packages %}
                  <tr>
                    <td style="padding:10px; border:1px solid #e5e7eb; vertical-align:top; font-weight:700;">
                      {{ p.house_awb }}
                    </td>

                    <td style="padding:10px; border:1px solid #e5e7eb; vertical-align:top;">
                      <div><b>Weight:</b> {{ p.weight }} lbs</div>
                      <div><b>USD Value:</b> ${{ "%.2f"|format(p.value or 0) }}</div>
                      <div style="color:#6b7280;">{{ p.description }}</div>
                    </td>

                    <td style="padding:10px; border:1px solid #e5e7eb; vertical-align:top;">
                      <div><b>Freight:</b> {{ (p.freight or 0)|jmd }}</div>
                      <div><b>Handling:</b> {{ (p.handling or 0)|jmd }}</div>
                      <div><b>Other:</b> {{ (p.other_charges or 0)|jmd }}</div>
                    </td>

                    <td style="padding:10px; border:1px solid #e5e7eb; vertical-align:top;">
                      <div><b>Duty:</b> {{ (p.duty or 0)|jmd }}</div>
                      <div><b>SCF:</b> {{ (p.scf or 0)|jmd }}</div>
                      <div><b>ENVL:</b> {{ (p.envl or 0)|jmd }}</div>
                      <div><b>CAF:</b> {{ (p.caf or 0)|jmd }}</div>
                      <div><b>GCT:</b> {{ (p.gct or 0)|jmd }}</div>
                    </td>

                    <td style="padding:10px; border:1px solid #e5e7eb; vertical-align:top;">
                      {{ (p.discount_due or 0)|jmd }}
                    </td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>

          </div>

          <!-- Footer -->
          <div style="margin-top:16px; text-align:center; color:#6b7280; font-size:12px; line-height:1.6;">
            <div><b style="color:#111827;">Foreign A Foot Logistics Limited</b></div>
            <div>Unit 7, Lot C22, Cedar Manor Gregory Park P.O. St. Catherine</div>
            <div>(876) 210-4291 Â· foreignafootlogistics@gmail.com</div>
          </div>
        </div>

      </div>
    </div>
  </body>
</html>
