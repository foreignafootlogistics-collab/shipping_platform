{% extends "layout_customer.html" %}
{% block title %}My Bills{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2 class="mb-4">My Bills</h2>

    <div class="card shadow-sm">
        <div class="card-body p-0">
            <table class="table table-hover table-striped table-bordered align-middle">
                <thead class="table-dark">
                    <tr>
                        <th scope="col">Bill ID</th>
                        <th scope="col">Package</th>
                        <th scope="col">Amount</th>
                        <th scope="col">Status</th>
                        <th scope="col">Due Date</th>
                        <th scope="col">Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% if bills %}
                        {% for bill in bills %}
                            <tr>
                                <td>{{ bill.id }}</td>
                                <td>{{ bill.package_description or bill.description }}</td>
                                <td>${{ "%.2f"|format(bill.amount) }}</td>
                                <td>
                                    {% if bill.status == 'pending' %}
                                        <span class="badge bg-warning text-dark">Pending</span>
                                    {% elif bill.status == 'paid' %}
                                        <span class="badge bg-success">Paid</span>
                                    {% else %}
                                        {{ bill.status }}
                                    {% endif %}
                                </td>
                                <td>{{ bill.due_date }}</td>
                                <td>
                                    {% if bill.invoice_id %}
                                        <a href="{{ url_for('customer.view_invoice', invoice_id=bill.invoice_id) }}"
                                           class="btn btn-sm btn-secondary">
                                            View Invoice
                                        </a>
                                    {% elif bill.status == 'pending' and bill.package_status == 'Overseas' %}
                                        <a href="{{ url_for('customer.submit_invoice', bill_id=bill.id) }}"
                                           class="btn btn-sm btn-primary">
                                            Submit Invoice
                                        </a>
                                    {% else %}
                                        <span class="text-muted">No Action</span>
                                    {% endif %}
                                </td>
                            </tr>
                        {% endfor %}
                    {% else %}
                        <tr>
                            <td colspan="6" class="text-center py-3">No bills found.</td>
                        </tr>
                    {% endif %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}
