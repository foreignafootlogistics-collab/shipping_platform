{% extends "layout_customer.html" %}
{% block title %}View Pre-Alert Shipments{% endblock %}

{% block content %}
<div class="container mt-4">
    <h3>ðŸ“¦ Your Pre-Alert Shipments</h3>

    <div class="d-flex justify-content-between mb-3">
        <a href="{{ url_for('customer.prealerts_create') }}" class="btn btn-dashboard">
          Create New Pre-Alert Shipment
        </a>
    </div>

    <!-- Flash messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <div class="table-responsive">
      <table class="table table-hover table-striped table-bordered align-middle">
        <thead class="table-dark">
          <tr>
            <th>Pre-Alert #</th>
            <th>Vendor</th>
            <th>Courier</th>
            <th>Tracking #</th>
            <th>Purchase Date</th>
            <th>Contents</th>
            <th>Value (USD)</th>
            <th>Invoice</th>
            <th>Submitted On</th>
          </tr>
        </thead>
        <tbody>
          {% if prealerts %}
            {% for p in prealerts %}
            <tr>
              <td>{{ p[0] }}</td>
              <td>{{ p[1] }}</td>
              <td>{{ p[2] }}</td>
              <td>{{ p[3] }}</td>
              <td>{{ p[4] if p[4] else 'N/A' }}</td>
              <td>{{ p[5] }}</td>
              <td>${{ "%.2f"|format(p[6]) }}</td>
              <td>
                {% if p[7] %}
                  <a href="{{ url_for('static', filename='invoices/' ~ p[7]) }}" target="_blank">View</a>
                {% else %}
                  N/A
                {% endif %}
              </td>
              <td>{{ p[8] if p[8] else 'N/A' }}</td>
            </tr>
            {% endfor %}
          {% else %}
            <tr>
              <td colspan="9" class="text-center text-muted">No pre-alert shipments available.</td>
            </tr>
          {% endif %}
        </tbody>
      </table>
    </div>
</div>
{% endblock %}
